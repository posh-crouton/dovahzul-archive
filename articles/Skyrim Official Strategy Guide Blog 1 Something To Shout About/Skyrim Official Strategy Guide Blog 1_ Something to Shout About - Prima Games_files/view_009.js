!function(){window.GAMURS_wordpress_blocks=window.GAMURS_wordpress_blocks||{},window.GAMURS_wordpress_blocks.auth=window.GAMURS_wordpress_blocks.auth||{},window.GAMURS_wordpress_blocks.auth.ui=window.GAMURS_wordpress_blocks.auth.ui||{},window.GAMURS_wordpress_blocks.auth.firebase=window.GAMURS_wordpress_blocks.auth.firebase||{};var o="is-visible",e=document.getElementById("wp-block-gamurs-auth-popup"),t=document.getElementById("wp-block-gamurs-auth-forgot"),s=document.getElementById("wp-block-gamurs-auth-login"),n=document.getElementById("wp-block-gamurs-auth-signup"),w=function(){e.classList.remove(o),window.GAMURS_wordpress_blocks.auth.ui.isOpen=!1,window.GAMURS_wordpress_blocks.auth.ui.forgot.resetState&&window.GAMURS_wordpress_blocks.auth.ui.forgot.resetState(),window.GAMURS_wordpress_blocks.auth.ui.login.resetState&&window.GAMURS_wordpress_blocks.auth.ui.login.resetState(),window.GAMURS_wordpress_blocks.auth.ui.signup.resetState&&window.GAMURS_wordpress_blocks.auth.ui.signup.resetState()},i=function(){t.classList.add(o),s.classList.remove(o),n.classList.remove(o)},a=function(){t.classList.remove(o),s.classList.add(o),n.classList.remove(o)},r=function(){t.classList.remove(o),s.classList.remove(o),n.classList.add(o)},c=function(t){if(t)switch(t){case"forgot":i();break;case"login":a();break;case"signup":r()}e.classList.add(o),window.GAMURS_wordpress_blocks.auth.ui.isOpen=!0,window.snowplow&&window.snowplow("trackStructEvent",{category:"GAMURS Account",action:"Popup Opened",label:t}),window.GAMURS_wordpress_blocks.auth.firebase.appChecked||(window.GAMURS_wordpress_blocks.auth.firebase.appCheck=window.GAMURS_wordpress_blocks.auth.firebase.app.appCheck(),window.GAMURS_wordpress_blocks.auth.firebase.appCheck.activate(new firebase.appCheck.ReCaptchaEnterpriseProvider(window.GAMURS_wordpress_blocks.auth.firebase.config.recaptchaEnterpriseKey),!0),window.GAMURS_wordpress_blocks.auth.firebase.appChecked=!0)},d=document.getElementById("wp-block-gamurs-auth-close");d&&d.addEventListener("click",(function(o){o.preventDefault(),window.snowplow&&window.snowplow("trackStructEvent",{category:"GAMURS Account",action:"Close Popup Clicked"}),w()}));var u=function(o,e){var t=o.user;window.snowplow&&window.snowplow("setUserId",t.uid),o.additionalUserInfo.isNewUser||t.metadata.createdAt===t.metadata.lastLoginat?(window.GAMURS_wordpress_blocks.auth.isSigningUp=!0,window.GAMURS_wordpress_blocks.auth.ui.signup.goToUsernameOnly(),window.GAMURS_wordpress_blocks.auth.ui.goToSignup(),window.snowplow&&window.snowplow("trackStructEvent",{category:"GAMURS Account",action:"Signed Up with SSO",label:e})):window.snowplow&&window.snowplow("trackStructEvent",{category:"GAMURS Account",action:"Logged In with SSO",label:e})},l=document.getElementById("wp-block-gamurs-auth-login-google"),p=document.getElementById("wp-block-gamurs-auth-signup-google");[l,p].forEach((function(o){o&&o.addEventListener("click",(function(e){e.preventDefault(),window.snowplow&&window.snowplow("trackStructEvent",{category:"GAMURS Account",action:l==o?"SSO Login Clicked":"SSO Signup Clicked",label:"Google"}),window.GAMURS_wordpress_blocks.auth.firebase.auth.signInWithPopup(new firebase.auth.GoogleAuthProvider).then((function(o){u(o,"Google")})).catch((function(o){console.log(o)}))}))}));var S=document.getElementById("wp-block-gamurs-auth-login-apple"),_=document.getElementById("wp-block-gamurs-auth-signup-apple");[S,_].forEach((function(o){o&&o.addEventListener("click",(function(e){e.preventDefault(),window.snowplow&&window.snowplow("trackStructEvent",{category:"GAMURS Account",action:S==o?"SSO Login Clicked":"SSO Signup Clicked",label:"Apple"}),window.GAMURS_wordpress_blocks.auth.firebase.auth.signInWithPopup(new firebase.auth.OAuthProvider("apple.com")).then((function(o){u(o,"Apple")})).catch((function(o){console.log(o)}))}))}));var b=function(){if(window.SPOTIM&&(console.log("start ow sso"),window.GAMURS_wordpress_blocks.auth.firebase.auth.currentUser&&window.GAMURS_wordpress_blocks.auth.firebase.app.functions&&window.GAMURS_wordpress_blocks.auth.ow.site)){var o=window.GAMURS_wordpress_blocks.auth.firebase.auth.currentUser;window.SPOTIM.startSSO({callback:function(o,e){window.GAMURS_wordpress_blocks.auth.firebase.functions.httpsCallable("openWebSSO")({code_a:o,site:window.GAMURS_wordpress_blocks.auth.ow.site}).then((function(o){var t=o.data;t&&e(t)})).catch((function(o){e(null,o)}))},userId:o.uid}).then((function(o){})).catch((function(o){}))}};window.GAMURS_wordpress_blocks.auth.openweb=window.GAMURS_wordpress_blocks.auth.openweb||{},window.GAMURS_wordpress_blocks.auth.openweb.startSSO=b,window.GAMURS_wordpress_blocks.auth.firebase&&firebase.auth().onAuthStateChanged((async o=>{if(o){var e=window.GAMURS_wordpress_blocks.auth.firebase.functions.httpsCallable("getUserOnboardingStatus"),t=await e({site:window.GAMURS_wordpress_blocks.auth.site});if(window.GAMURS_wordpress_blocks.auth.onboardingStatus=t.data,!window.GAMURS_wordpress_blocks.auth.isSigningUp){if(window.snowplow&&(window.snowplow("setUserId",o.uid),window.snowplow("trackStructEvent",{category:"GAMURS Account",action:"Logged In"})),window.GAMURS_wordpress_blocks.auth.ui.close(),window.GAMURS_wordpress_blocks.auth.site){var s=window.GAMURS_wordpress_blocks.auth.firebase.functions.httpsCallable("trackSite");await s({site:window.GAMURS_wordpress_blocks.auth.site})}t.data.username&&(window.SPOTIM&&window.SPOTIM.startSSO?b():document.addEventListener("spot-im-api-ready",b,!1),document.addEventListener("spot-im-renew-sso",b,!1))}}else window.SPOTIM&&window.SPOTIM.logout?window.SPOTIM.logout():document.addEventListener("spot-im-api-ready",(function(){window.SPOTIM.logout()}),!1),console.log("user logged out"),window.snowplow&&window.snowplow("trackStructEvent",{category:"GAMURS Account",action:"Logged Out"})})),window.GAMURS_wordpress_blocks.auth.ui.isOpen=!1,window.GAMURS_wordpress_blocks.auth.ui.open=c,window.GAMURS_wordpress_blocks.auth.ui.close=w,window.GAMURS_wordpress_blocks.auth.ui.goToForgot=i,window.GAMURS_wordpress_blocks.auth.ui.goToLogin=a,window.GAMURS_wordpress_blocks.auth.ui.goToSignup=r,document.addEventListener("spot-im-login-start",(function(o){window.snowplow&&window.snowplow("trackStructEvent",{category:"GAMURS Account",action:"OpenWeb Login Clicked"}),c("login")})),document.addEventListener("spot-im-signup-start",(function(o){window.snowplow&&window.snowplow("trackStructEvent",{category:"GAMURS Account",action:"OpenWeb Signup Clicked"}),c("signup")})),document.addEventListener("spot-im-user-logout",(function(o){window.GAMURS_wordpress_blocks.auth.firebase&&window.GAMURS_wordpress_blocks.auth.firebase.auth&&window.GAMURS_wordpress_blocks.auth.firebase.auth.signOut().then((()=>{window.snowplow&&window.snowplow("trackStructEvent",{category:"GAMURS Account",action:"OpenWeb Logout Clicked"})})).catch((o=>{}))}))}();